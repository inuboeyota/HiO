# HiO (Holistic infrastructure Orchestrator) の説明  

**Holistic infrastructure Orchestrator（包括的基盤オーケストレータ）**：略してHiO。愛称は「ひお」  
たまたま機能に合うような英単語を探していたら、こんなにかわいい名前になってしまいました。特に意味はありません。信じてください！  

## SLA？的なの  

- サッと書いて、スッと動く
- アカウント発行から使用したい機能が実行されるまで、15分。（※既存機能の場合）
- 汎用化できる機能はユーザ側でノーコードでカスタマイズ可能にして、即座に使えるように。

---

### リリース時期  

汎用機能をいくつか積んでから、初めて登場させます。2025/06/01目途←むずくね？

| リリース  | 内容                   | 日付        |
| :-------- | :--------------------- | :---------- |
| ver0.9.0. | HiOの基盤導入          | 2025/06/01  |
| ver1.0.0. | サーバーへの導入       | 2025/07まで |

---

## HiOの定義  

- HiOは前提として10~20のサーバで同時に動くことを前提にする
- HiOは少なくともprefixやslashのCommandについては最下層に一度書けば、再起動時には何も意識せずに実行可能になる構成を持つ
  - 再起動時でなく、読み込みを行う関数を実装してもいいかも…と思ったが、結局tsからjsにコンパイルする必要があるからダメかも。
- HiOは以下でイベント/コマンドの発生・使用権限を管理する
  - サーバ（Guild）
  - チャンネル（Channel）
  - メンバー（Member）（=Guild x User）
  - ユーザー（User）←メンテ時とか、HiO開発者用とかの為に実装。通常はMemberで事足りそうだけど。
- HiOはDiscordAPI側で用意されている汎用的なイベントに対し、そのすべての発火点から直接実行されるイベント（と、その条件分岐）は、prefixやslashと同様に単一のファイルにおける実装で、上位の階層を意識せずに実行可能にできる構成を持つ
- HiOはnode-cronなどによる定期的なイベント実行についても、やはり処理内容のみの実装で事足りるような設計を持つ  
- HiOは、権限情報や各種設定値などのマスタや、イベントの状態管理を行うためのDBを持っている
  - P的事務員BotのときはGoogleSpreadSheetAPIを用いて疑似クラウドRDBを持たせていたが、開発機と鯖機の間に接続ができたので、SQLiteとかでいいんじゃないかと思っている
- HiOは、今後作るあらゆるbotの開発に役立つ、core部分を抜き出せるような構造になっている

## ディレクトリ構成？

docs  
├── カス仕様書.md  カスの仕様書。最新化はしない(カスなので)  
└── ひおメモ.md #開発時のメモや使用についてのFAQ  
src  
├── msgTrigger  
│   ├── commands  #コマンドを入れる。preかslaかは内部で判断  
│   │   └── ping.ts  
│   └── format  
│       └── selfIntroduced.ts  
├── config # 環境変数以外のbotの設定値を入れる予定だけど、今のとこ使用用途は不明  
├── core   #loaderなどの、main.tsと密に結合するコア機能  
│   ├── loader.ts  
│   └── permissions.ts  
├── events #messageCreateとinteraction以外のイベントはここに  
├── jobs #node-cronなどの定期実行イベントはここ  
├── models #マッピング後のEntitiesはここに  
├── type #型定義  
│   └── command.ts  
├── bot.ts   #Clientの生成  
└── main.ts  #エントリーポイント  
